<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Isabelle Smith" />

<meta name="date" content="2025-02-19" />

<title>Homework 6</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel="shortcut icon" type="image/png" href="icon-hi.png" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Isabelle Smith - Biol 6100</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-house"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-circle-info"></span>
     
    About
  </a>
</li>
<li>
  <a href="homework.html">
    <span class="fa fa-file"></span>
     
    Homework
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Homework 6</h1>
<h4 class="author">Isabelle Smith</h4>
<h4 class="date">2025-02-19</h4>

</div>


<p> </p>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p><strong>Think about an ongoing study in your lab (or a paper you have
read in a different class), and decide on a pattern that you might
expect in your experiment if a specific hypothesis were
true.</strong></p>
<p>I am looking at sleep (and other health metrics) broken out by major
(and other demographics). I hypothesize that easier majors would have
better sleep.</p>
<p> </p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p><strong>To start simply, assume that the data in each of your
treatment groups follow a normal distribution. Specify the sample sizes,
means, and variances for each group that would be reasonable if your
hypothesis were true. You may need to consult some previous literature
and/or an expert in the field to come up with these
numbers.</strong></p>
<p>I will look at three majors (easy, medium, hard) and total sleep time
(in hours):</p>
<ul>
<li><span class="math inline">\(\mbox{sleep}_E \sim \mbox{N}
(9,0.5)\)</span> and <span class="math inline">\(n_E = 30\)</span><br />
</li>
<li><span class="math inline">\(\mbox{sleep}_M \sim \mbox{N}
(8,0.5)\)</span> and <span class="math inline">\(n_M = 50\)</span><br />
</li>
<li><span class="math inline">\(\mbox{sleep}_H \sim \mbox{N}
(7,0.5)\)</span> and <span class="math inline">\(n_H = 20\)</span></li>
</ul>
<p>I chose the group means based on the recommended amount of sleep [<a
href="https://www.nhlbi.nih.gov/health/sleep/how-much-sleep">source</a>]
and varied them to follow my hypothesis (more sleep = better).</p>
<p>I chose an equal variance for the groups to fit the ANOVA assumptions
and a value of 0.5 based on the 68-95-99.7 rule for the normal
distribution.</p>
<p>I chose a total sample size of 100, and group sizes based on the
expectation that hard majors would be the least popular and medium ones
would be the most common.</p>
<p> </p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p><strong>Using the methods we have covered in class, write code to
create a random data set that has these attributes. Organize these data
into a data frame with the appropriate structure.</strong></p>
<pre class="r"><code>major = rep(c(&quot;E&quot;,&quot;M&quot;,&quot;H&quot;), c(30,50,20))
sleep = c(rnorm(30,9,0.5),
          rnorm(50,8,0.5),
          rnorm(20,7,0.5))

df &lt;- data.frame(major=factor(major, levels=c(&quot;E&quot;,&quot;M&quot;,&quot;H&quot;)),
                 sleep=sleep)

str(df)</code></pre>
<pre><code>## &#39;data.frame&#39;:    100 obs. of  2 variables:
##  $ major: Factor w/ 3 levels &quot;E&quot;,&quot;M&quot;,&quot;H&quot;: 1 1 1 1 1 1 1 1 1 1 ...
##  $ sleep: num  9.55 9.32 9.52 9.08 9.57 ...</code></pre>
<p> </p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p><strong>Now write code to analyze the data (probably as an ANOVA or
regression analysis, but possibly as a logistic regression or
contingency table analysis. Write code to generate a useful graph of the
data.</strong></p>
<pre class="r"><code>mod &lt;- aov(sleep ~ major, data=df)

anova(mod)</code></pre>
<pre><code>## Analysis of Variance Table
## 
## Response: sleep
##           Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## major      2 57.517 28.7586  93.005 &lt; 2.2e-16 ***
## Residuals 97 29.994  0.3092                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<pre class="r"><code>## - - - - - - -

library(ggplot2)</code></pre>
<pre><code>## Warning: package &#39;ggplot2&#39; was built under R version 4.3.3</code></pre>
<pre class="r"><code>ggplot(df, aes(x=major, y=sleep)) +
  
  geom_boxplot(aes(fill=major)) +
  
  scale_x_discrete(labels=c(&quot;Easy&quot;,&quot;Medium&quot;,&quot;Hard&quot;)) +
  
  scale_y_continuous(breaks=seq(6,10,0.5)) +
  
  labs(title=&quot;Difference in Sleep By Major&quot;,
       x=&quot;Major Difficulty&quot;,
       y=&quot;Hours of Sleep&quot;) +
  
  theme(plot.title=element_text(hjust=0.5, vjust=4),
        plot.subtitle=element_text(hjust=0.5, vjust=4),
        plot.caption=element_text(vjust=-7),
        axis.title.x=element_text(vjust=-4),
        axis.title.y=element_text(vjust=5),
        plot.margin=margin(1, 1, 1, 1, &quot;cm&quot;),
        legend.position=&quot;none&quot;)</code></pre>
<p><img src="HW05-fake-data-set_files/figure-html/q4-1.png" width="672" /></p>
<p>Using an ANOVA, we find a significant difference in mean amount of
sleep by major in our generated data. This difference is highlighted in
the boxplots, as there is no overlap between the IQRs of any groups.</p>
<p> </p>
</div>
<div id="question-5" class="section level2">
<h2>Question 5</h2>
<p><strong>Try running your analysis multiple times to get a feeling for
how variable the results are with the same parameters, but different
sets of random numbers.</strong></p>
<pre class="r"><code>################################################################################

## FUNCTION: fake_data_analysis

## built-in: levels         =     E    /  M  /    H
## built-in: group sizes    =     3    /  5  /    2
## built-in: means          =  mid-dif / mid / mid+dif

## input: mid     = middle value          ~ any real
## input: dif     = effect size           ~ any real
## input: sigma   = variance              ~ &gt;= 0
## input: n       = sample size factor    ~ &gt;= 1

## output: `aov` model

## -----------------------------------------------------------------------------

fake_data_analysis = function(mid=8, dif=-1, sigma=0.5, n=10){
  
  ## making data
  
  M = c(mid-dif, mid, mid+dif)
  
  N = n * c(3,5,2)
  
  major = rep(c(&quot;E&quot;,&quot;M&quot;,&quot;H&quot;), N)
  
  sleep = c(rnorm(N[1],M[1],sigma),
            rnorm(N[2],M[2],sigma),
            rnorm(N[3],M[3],sigma))
  
  df &lt;- data.frame(major=factor(major, levels=c(&quot;E&quot;,&quot;M&quot;,&quot;H&quot;)),
                  sleep=sleep)
  
  ## fitting model
  
  mod &lt;- anova(aov(sleep ~ major, data=df))
  
  ## output
  
  return(mod$`Pr(&gt;F)`[1])
  
}

################################################################################

set.seed(91)

for (i in 1:5){
  cat(&quot;Try&quot;, i, &quot;: p-value =&quot;, signif(fake_data_analysis(),3), &quot;\n&quot;)
}</code></pre>
<pre><code>## Try 1 : p-value = 4.04e-21 
## Try 2 : p-value = 1.04e-25 
## Try 3 : p-value = 4.94e-22 
## Try 4 : p-value = 3.69e-27 
## Try 5 : p-value = 1.1e-24</code></pre>
<p>Repeating this process multiple times with the same parameters, we
get different p-values (but all significant and very small).</p>
<p> </p>
</div>
<div id="question-6" class="section level2">
<h2>Question 6</h2>
<p><strong>Now, using a series of for loops, adjust the parameters of
your data to explore how they might impact your results/analysis, and
store the results of your for loops into an object so you can view it.
For example, what happens if you were to start with a small sample size
and then re-run your analysis? Would you still get a significant result?
What if you were to increase that sample size by 5, or 10? How small can
your sample size be before you detect a significant pattern (p &lt;
0.05)? How small can the differences between the groups be (the “effect
size”) for you to still detect a significant pattern?</strong></p>
<pre class="r"><code>set.seed(91)

x.dif = c(0.25, 0.5, 0.75, 1)
x.n = c(1, 2, 5, 10)

x.out = rep(NA, length(x.dif)*length(x.n))

count = 0

for (i in 1:length(x.dif)){
  
  for (j in 1:length(x.n)){
    
    count = count + 1
    x.out[count] = fake_data_analysis(mid=8, dif=x.dif[i], sigma=0.5, n=x.n[j])
    
  }
  
}

results = data.frame(effect.size = rep(x.dif, rep(length(x.n),length(x.dif))),
                     sample.size = rep(x.n, length(x.dif)),
                     pvalues = x.out,
                     significant = x.out&lt;0.05)

ggplot(results, aes(x=effect.size, y=pvalues, color=significant)) +
  
  geom_point(size=2.5) +
  
  facet_wrap(~sample.size, nrow=1) +
  
  scale_x_continuous(breaks=seq(0,1,0.25)) +
  
  scale_color_manual(breaks = c(TRUE, FALSE),
                     values = scales::hue_pal(direction=-1)(2)) +
  
  labs(title=&quot;3-Group ANOVA Results by Relative Sample Size&quot;,
       x=&quot;Difference Between Goups&quot;,
       y=&quot;P-Values&quot;,
       color=&quot;Significant?&quot;) +
   
   theme(plot.title=element_text(hjust=0.5, vjust=4),
         plot.subtitle=element_text(hjust=0.5, vjust=4),
         plot.caption=element_text(vjust=-7),
         axis.title.x=element_text(vjust=-4),
         axis.title.y=element_text(vjust=5),
         plot.margin=margin(1, 1, 1, 1, &quot;cm&quot;),
         legend.position=&quot;top&quot;)</code></pre>
<p><img src="HW05-fake-data-set_files/figure-html/q6-1.png" width="672" /></p>
<p>Keeping an equal variance of 0.5: for a small sample size (factor of
1 means n=10), a difference of 0.75 between groups is needed to detect a
significant difference. For medium sample sizes (n=20 and 50), a lower
difference of 0.5 between groups is needed to detect a significant
difference. And a larger sample size (n=100) detected a significant
difference at all tested differences.</p>
<p> </p>
</div>
<div id="question-7" class="section level2">
<h2>Question 7</h2>
<p><strong>Alternatively, for the effect sizes you originally
hypothesized, what is the minimum sample size you would need in order to
detect a statistically significant effect? Again, run the model a few
times with the same parameter set to get a feeling for the effect of
random variation in the data.</strong></p>
<pre class="r"><code>set.seed(91)

for (i in 1:5){
  cat(&quot;Try&quot;, i, &quot;: p-value =&quot;, signif(fake_data_analysis(mid=8, dif=-1, sigma=0.5, n=1),3), &quot;\n&quot;)
}</code></pre>
<pre><code>## Try 1 : p-value = 0.0105 
## Try 2 : p-value = 0.000479 
## Try 3 : p-value = 0.0557 
## Try 4 : p-value = 0.00626 
## Try 5 : p-value = 0.0137</code></pre>
<p>The original difference of 1 between groups was significant at all
tested sample sizes in the previous results, so I used the smallest
value (factor of 1). Using this, 4/5 different data sets with the same
creation parameters were found to have significant difference in group
means via ANOVA.</p>
<p> </p>
</div>
<div id="question-8" class="section level2">
<h2>Question 8</h2>
<p><strong>Write up your results in a markdown file, organized with
headers and different code chunks to show your analysis. Be explicit in
your explanation and justification for sample sizes, means, and
variances.</strong></p>
</div>




</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
