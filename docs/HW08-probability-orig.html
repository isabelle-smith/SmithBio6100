<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Isabelle Smith" />

<meta name="date" content="2025-03-19" />

<title>Homework 8 (original)</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-6.5.2/css/all.min.css" rel="stylesheet" />
<link href="site_libs/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet" />
<link rel="shortcut icon" type="image/png" href="icon-hi.png" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="custom.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->




</head>

<body>


<div class="container-fluid main-container">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Isabelle Smith - Biol 6100</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">
    <span class="fa fa-house"></span>
     
    Home
  </a>
</li>
<li>
  <a href="about.html">
    <span class="fa fa-circle-info"></span>
     
    About
  </a>
</li>
<li>
  <a href="homework.html">
    <span class="fa fa-file"></span>
     
    Homework
  </a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Homework 8 (original)</h1>
<h4 class="author">Isabelle Smith</h4>
<h4 class="date">2025-03-19</h4>

</div>


<p> </p>
<div id="simulating-and-fitting-data-distributions"
class="section level3">
<h3>Simulating and Fitting Data Distributions</h3>
<p>This exercise teaches you how to compare a histogram of continuous
(or integer) data to the probability density functions for different
statistical distributions.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Run the sample code.</strong> Set up a new
<code>.Rmd</code> file for this exercise. Copy and paste the code below
into different code chunks, and then read the text and run the code
chunks one at a time to see what they do. You probably won’t understand
everything in the code, but this is a good start for seeing some
realistic uses of <code>ggplot</code>. We will cover most of these
details in the next few weeks.</p></li>
<li><p><strong>Try it with your own data</strong>. Once the code is in
and runs, try running this analysis on your own data (or data from your
lab, or data from a published paper; if you’re stumped, check out
publicly available data sets on <a
href="https://datadryad.org/search">Dryad</a>, <a
href="https://data.esa.org">ESA</a>, or the <a
href="https://lternet.edu/">LTER Network</a>). Find a vector of data (of
any size), set it up in a <code>.csv</code> file, and read the data into
a data frame with this code chunk:</p></li>
</ol>
<pre class="r"><code>z &lt;- read.table(&quot;MyDataFile.csv&quot;,header=TRUE,sep=&quot;,&quot;)
str(z)
summary(z)</code></pre>
<p>George will be able to help you if you are having trouble reading in
the data.</p>
<p>Once your data are in, go ahead and comment out the “fake data” that
are simulated in the chunk below. At that point, if you compile the
entire file, it should run all of the code on your own data. Be sure to
add comments to the code and commentary to the <code>.Rmd</code> file so
that you can go back to it later and understand and use the code in your
work.</p>
<ol start="3" style="list-style-type: decimal">
<li><p><strong>Find best-fitting distribution</strong>. Take a look at
the second-to-last graph which shows the histogram of your data and 4
probability density curves (normal, uniform, exponential, gamma) that
are fit to the data. Find the best-fitting distribution for your data.
For most data sets, the gamma will probably fit best, but if you data
set is small, it may be very hard to see much of a difference between
the curves. The <code>beta</code> distribution in the final graph is
somewhat special. It often fits the data pretty well, but that is
because we have assumed the largest data point is the true upper bound,
and everything is scaled to that. The fit of the uniform distribution
also fixes the upper bound. The other curves (normal, exponential, and
gamma) are more realistic because they do not have an upper
bound.</p></li>
<li><p><strong>Simulate a new data set</strong>. Using the best-fitting
distribution, go back to the code and get the maximum likelihood
parameters. Use those to simulate a new data set, with the same length
as your original vector, and plot that in a histogram and add the
probability density curve. Right below that, generate a fresh histogram
plot of the original data, and also include the probability density
curve.</p></li>
</ol>
<p>How do the two histogram profiles compare? Do you think the model is
doing a good job of simulating realistic data that match your original
measurements? Why or why not?</p>
<p>If you have entered a large data frame with many columns, try running
all of the code on a different variable to see how the simulation
performs.</p>
<p>Once we get a little bit more R coding under our belts, we will
return to the problem of simulating data and use some of this code
again.</p>
<hr />
<p> </p>
<div id="open-libraries" class="section level4">
<h4>Open libraries</h4>
<pre class="r"><code>library(ggplot2) # for graphics
library(MASS) # for maximum likelihood estimation</code></pre>
<pre><code>## 
## Attaching package: &#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:dplyr&#39;:
## 
##     select</code></pre>
</div>
<div id="read-in-data-vector" class="section level4">
<h4>Read in data vector</h4>
<p>To illustrate, we will generate some fake data here:</p>
<pre class="r"><code># quick and dirty, a truncated normal distribution to work on the solution set

z &lt;- rnorm(n=3000,mean=0.2)
z &lt;- data.frame(1:3000,z)
names(z) &lt;- list(&quot;ID&quot;,&quot;myVar&quot;)
z &lt;- z[z$myVar&gt;0,]
str(z)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1697 obs. of  2 variables:
##  $ ID   : int  5 6 9 10 12 13 14 15 16 17 ...
##  $ myVar: num  0.00889 0.44726 0.13129 0.60816 2.16118 ...</code></pre>
<pre class="r"><code>summary(z$myVar)</code></pre>
<pre><code>##     Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
## 0.000511 0.386020 0.773108 0.881715 1.267939 3.164461</code></pre>
<p>In the third step of this exercise, you wil substitute in your own
data for this fake data set. But for now, use the code chunks below to
see how you fit different statistical distributions to a vector of
observations, and then estimate the maximum likelihood parameters for
each distribution.</p>
</div>
<div id="plot-histogram-of-data" class="section level4">
<h4>Plot histogram of data</h4>
<p>Plot a histogram of the data, using a modification of the code from
lecture. Here we are switching from <code>qplot</code> to
<code>ggplot</code> for more graphics options. We are also rescaling the
y axis of the histogram from counts to density, so that the area under
the histogram equals 1.0.</p>
<pre class="r"><code>p1 &lt;- ggplot(data=z, aes(x=myVar, y=..density..)) +
  geom_histogram(color=&quot;grey60&quot;,fill=&quot;cornsilk&quot;,size=0.2) </code></pre>
<pre><code>## Warning: Using `size` aesthetic for lines was deprecated in ggplot2
## 3.4.0.
## ℹ Please use `linewidth` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where
## this warning was generated.</code></pre>
<pre class="r"><code>print(p1)</code></pre>
<pre><code>## Warning: The dot-dot notation (`..density..`) was deprecated in
## ggplot2 3.4.0.
## ℹ Please use `after_stat(density)` instead.
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_lifecycle_warnings()` to see where
## this warning was generated.</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="HW08-probability-orig_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="add-empirical-density-curve" class="section level4">
<h4>Add empirical density curve</h4>
<p>Now modify the code to add in a kernel density plot of the data. This
is an empirical curve that is fitted to the data. It does not assume any
particular probability distribution, but it smooths out the shape of the
histogram:</p>
<pre class="r"><code>p1 &lt;-  p1 +  geom_density(linetype=&quot;dotted&quot;,size=0.75)
print(p1)</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="HW08-probability-orig_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="get-maximum-likelihood-parameters-for-normal"
class="section level4">
<h4>Get maximum likelihood parameters for <code>normal</code></h4>
<p>Next, fit a normal distribution to your data and grab the maximum
likelihood estimators of the two parameters of the normal, the mean and
the variance:</p>
<pre class="r"><code>normPars &lt;- fitdistr(z$myVar,&quot;normal&quot;)
print(normPars)</code></pre>
<pre><code>##       mean          sd    
##   0.88171470   0.61466172 
##  (0.01492091) (0.01055068)</code></pre>
<pre class="r"><code>str(normPars)</code></pre>
<pre><code>## List of 5
##  $ estimate: Named num [1:2] 0.882 0.615
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ sd      : Named num [1:2] 0.0149 0.0106
##   ..- attr(*, &quot;names&quot;)= chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ vcov    : num [1:2, 1:2] 0.000223 0 0 0.000111
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##   .. ..$ : chr [1:2] &quot;mean&quot; &quot;sd&quot;
##  $ n       : int 1697
##  $ loglik  : num -1582
##  - attr(*, &quot;class&quot;)= chr &quot;fitdistr&quot;</code></pre>
<pre class="r"><code>normPars$estimate[&quot;mean&quot;] # note structure of getting a named attribute</code></pre>
<pre><code>##      mean 
## 0.8817147</code></pre>
</div>
<div id="plot-normal-probability-density" class="section level4">
<h4>Plot <code>normal</code> probability density</h4>
<p>Now let’s call the <code>dnorm</code> function inside ggplot’s
<code>stat_function</code> to generate the probability density for the
normal distribution. Read about <code>stat_function</code> in the help
system to see how you can use this to add a smooth function to any
ggplot. Note that we first get the maximum likelihood parameters for a
normal distribution fitted to thse data by calling
<code>fitdistr</code>. Then we pass those parameters
(<code>meanML</code> and <code>sdML</code> to
<code>stat_function</code>):</p>
<pre class="r"><code>meanML &lt;- normPars$estimate[&quot;mean&quot;]
sdML &lt;- normPars$estimate[&quot;sd&quot;]

xval &lt;- seq(0,max(z$myVar),len=length(z$myVar))

 stat &lt;- stat_function(aes(x = xval, y = ..y..), fun = dnorm, colour=&quot;red&quot;, n = length(z$myVar), args = list(mean = meanML, sd = sdML))
 p1 + stat</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="HW08-probability-orig_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<p>Notice that the best-fitting normal distribution (red curve) for
these data actually has a biased mean. That is because the data set has
no negative values, so the normal distribution (which is symmetric) is
not working well.</p>
</div>
<div id="plot-exponential-probability-density" class="section level4">
<h4>Plot <code>exponential</code> probability density</h4>
<p>Now let’s use the same template and add in the curve for the
exponential:</p>
<pre class="r"><code>expoPars &lt;- fitdistr(z$myVar,&quot;exponential&quot;)
rateML &lt;- expoPars$estimate[&quot;rate&quot;]

stat2 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dexp, colour=&quot;blue&quot;, n = length(z$myVar), args = list(rate=rateML))
 p1 + stat + stat2</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="HW08-probability-orig_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="plot-uniform-probability-density" class="section level4">
<h4>Plot <code>uniform</code> probability density</h4>
<p>For the uniform, we don’t need to use <code>fitdistr</code> because
the maximum likelihood estimators of the two parameters are just the
minimum and the maximum of the data:</p>
<pre class="r"><code>stat3 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dunif, colour=&quot;darkgreen&quot;, n = length(z$myVar), args = list(min=min(z$myVar), max=max(z$myVar)))
 p1 + stat + stat2 + stat3</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="HW08-probability-orig_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="plot-gamma-probability-density" class="section level4">
<h4>Plot <code>gamma</code> probability density</h4>
<pre class="r"><code>gammaPars &lt;- fitdistr(z$myVar,&quot;gamma&quot;)</code></pre>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<pre class="r"><code>shapeML &lt;- gammaPars$estimate[&quot;shape&quot;]
rateML &lt;- gammaPars$estimate[&quot;rate&quot;]

stat4 &lt;- stat_function(aes(x = xval, y = ..y..), fun = dgamma, colour=&quot;brown&quot;, n = length(z$myVar), args = list(shape=shapeML, rate=rateML))
 p1 + stat + stat2 + stat3 + stat4</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<p><img src="HW08-probability-orig_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="plot-beta-probability-density" class="section level4">
<h4>Plot <code>beta</code> probability density</h4>
<p>This one has to be shown in its own plot because the raw data must be
rescaled so they are between 0 and 1, and then they can be compared to
the beta.</p>
<pre class="r"><code>pSpecial &lt;- ggplot(data=z, aes(x=myVar/(max(myVar + 0.1)), y=..density..)) +
  geom_histogram(color=&quot;grey60&quot;,fill=&quot;cornsilk&quot;,size=0.2) + 
  xlim(c(0,1)) +
  geom_density(size=0.75,linetype=&quot;dotted&quot;)

betaPars &lt;- fitdistr(x=z$myVar/max(z$myVar + 0.1),start=list(shape1=1,shape2=2),&quot;beta&quot;)</code></pre>
<pre><code>## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced
## Warning in densfun(x, parm[1], parm[2], ...): NaNs produced</code></pre>
<pre class="r"><code>shape1ML &lt;- betaPars$estimate[&quot;shape1&quot;]
shape2ML &lt;- betaPars$estimate[&quot;shape2&quot;]

statSpecial &lt;- stat_function(aes(x = xval, y = ..y..), fun = dbeta, colour=&quot;orchid&quot;, n = length(z$myVar), args = list(shape1=shape1ML,shape2=shape2ML))
pSpecial + statSpecial</code></pre>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with
## `binwidth`.</code></pre>
<pre><code>## Warning: Removed 2 rows containing missing values or values outside
## the scale range (`geom_bar()`).</code></pre>
<p><img src="HW08-probability-orig_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
</div>

<div class="footer">
  <p><code>2025</code> Isabelle Smith for Biol 6100 at the University of Vermont</p>
</div>



</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
